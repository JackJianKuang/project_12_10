---
title: 'Exploratory Data Analysis Case Study Project #1'
author: "Nitin Seelam, Edmund Tran, Jian Kuang"
date: "December 4, 2015"
output: html_document
runtime: shiny
---

dictionary_URL : "https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FPUMSDataDict06.pdf"

```{r load_data}
df_data <- read.csv("data/ss14hca.csv")
```

### Nitin

```{r}
hist(df_data$FINCP,main="Family Income",col="Red",xlab="Income")
```

```{r}
plot(df_data$BDSP,df_data$FINCP, col="blue",xlab="Number of Rooms", ylab="Family Income",main="Bedrooms by Income")
```

```{r}
boxplot(VALP~BDSP,df_data)
```


```{r}
dataMatrix <- na.omit(df_data[,c("VALP", "BDSP", "YBL")])
dataMatrix1<- dataMatrix[1:10000,]
pairs(~BDSP + VALP + YBL, data=dataMatrix1,main="Scatterplots on Housing Factors")
```

### Edmund

We'll show how effective a sample mean is at estimating the population mean

Sample: monthly rents of x properties
Population: monthly rents of all properties in California (52,358 data points).
Population Mean: $1,249


```{r, echo=FALSE}
inputPanel(
  sliderInput("sample_size", label = "Sample Size:",
              min = 10, max = 100, value = 10, step = 10)
)

renderPlot({
  meanV <- NULL
  allRents <- df_data[complete.cases(df_data$RNTP), "RNTP"]
  # choose sample 1000x
  for (i in 1:1000) {
    sampleRents <- sample(allRents, input$sample_size)
    meanV <- c(meanV, mean(sampleRents))
  }

  hist(meanV,
     xlab = "Sample Mean",
     ylab = "Frequency",
     xlim = c(600, 1800),
     ylim = c(0, 400),
     main = "Distribution of 1000 Sample Means of Monthly Rents in CA")
  
  # show mean on graph for reference
  abline(v = mean(allRents), col = "red")
})
```


### Jack Kuang

How many bedrooms in each house ?  
```{r bedrooms}
table(df_data$BDSP)
barplot(table(df_data$BDSP))
```

How is the rent looks like ?
```{r rent}
# RNTP : monthly rent
hist(df_data$RNTP)
```

What's the relationship between number of bedroom and rent ?
```{r bedroom_rent}
boxplot(RNTP ~ BDSP, df_data)
```

Histgram of Property Value and Insurance
```{r}
hist(df_data$VALP)
hist(df_data$INSP)
```

Use only 2 numeric variables, cluster the dataset, what can you say about it?  
```{r cluster_2vars, echo=FALSE}
inputPanel(
  selectInput("n_clusters", label = "Number of clusters:",
              choices = c(2, 3, 5, 10), selected = 3)
)

## cluster property value(VALP), insurance(INSP)
dataMatrix <- na.omit(df_data[,c("VALP", "INSP")])
dataMatrix.scaled <- scale(dataMatrix)

renderPlot({
    kmeansObj <- kmeans(dataMatrix.scaled, centers = as.numeric(input$n_clusters))
    plot(dataMatrix, col=kmeansObj$cluster, main = "cluster on property value(VALP) and insurance(INSP)", 
         xlab="property value(VALP)", ylab = "insurance(INSP)")
})
```

Include 3 more numeric variables you think are sensible, cluster again, what are the results and why do you see that results?
```{r cluster_3vars}
## cluster property value(VALP), insurance(INSP), year buit (YBL)
dataMatrix2 <- na.omit(df_data[,c("VALP", "INSP", "YBL")])
dataMatrix2.scaled <- scale(dataMatrix2)
kmeansObj2 <- kmeans(dataMatrix2.scaled, centers = 3)
plot(dataMatrix2, col=kmeansObj2$cluster)

table(kmeansObj2$cluster)
```


