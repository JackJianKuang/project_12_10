---
title: 'Exploratory Data Analysis Case Study Project #1'
author: "Nitin Seelam, Jian Kuang"
date: "December 4, 2015"
output: html_document
runtime: shiny
---

dictionary_URL : "https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FPUMSDataDict06.pdf"

```{r}
df_data <- read.csv("data/ss14hca.csv")
```

### Nitin

```{r,echo=FALSE,results=FALSE}
Multigenerational <- df_data$MULTG
LimitedEnglish <- df_data$LNGI
MovedintoHouse <- df_data$MV
NumbofChildren <- df_data$NOC
MonthlyRent <- df_data$RNTP
```

```{r}
hist(df_data$FINCP,main="Family Income",col="Red",xlab="Income")
plot(df_data$BDSP,df_data$FINCP, col="blue",xlab="Number of Rooms", ylab="Family Income",main="Bedrooms by Income")


```

### Jack Kuang

Q5. How many 5 or more bedroom housese in the state of California?  
```{r}
table(df_data$BDSP)
barplot(table(df_data$BDSP))

# RNTP : monthly rent
hist(df_data$RNTP)

boxplot(RNTP ~ BDSP, df_data)

```
Q6. How many houses have both the presence of persons 65 years over AND 18 years younger?
```{r}
# R18: Presence of persons under 18 years in household (unweighted)
# R65: Presence of persons 65 years and over in household (unweighted)
sum(df_data$R18 == 1 & df_data$R65 %in% c(1, 2))



```
Q7. Whatâ€™s the probability of a 3 bedroom house have both younger (<18yrs) and older(>65yrs) residents ? 
```{r}
df_BDS_3 <- df_data[df_data$BDS == 3,]
df_BDS_3_sub <- df_BDS_3[df_BDS_3$R18==1 & df_BDS_3$R65 %in% c(1,2),]
(prob <- nrow(df_BDS_3_sub) / nrow(df_BDS_3))
```
Q8. Compare the result from Q7 between California and Idho, what can you say about it?  
Q9. How do you use distant metric to measure categorical variables?  
Q10. Use only 2 numeric variables, cluster the dataset, what can you say about it?  
```{r}
## cluster property value(VALP), insurance(INSP)
dataMatrix <- na.omit(df_data[,c("VALP", "INSP", "HINCP")])
dataMatrix.scaled <- dataMatrix[,-3]
kmeansObj <- kmeans(dataMatrix.scaled, centers = 5)
plot(dataMatrix[,-3], col=kmeansObj$cluster)

dataMatrix$hincpppp <- cut(dataMatrix[,3], breaks = 5)

table(kmeansObj$cluster, dataMatrix$hincpppp)
# t(dataMatrix)[, order(kmeansObj$cluster)]

## cluster property value(VALP), insurance(INSP), year buit (YBL)
dataMatrix <- na.omit(df_data[,c("VALP", "INSP", "YBL")])
dataMatrix.scaled <- scale(dataMatrix)
kmeansObj <- kmeans(dataMatrix.scaled, centers = 3)
plot(dataMatrix, col=kmeansObj$cluster)

table(kmeansObj$cluster)
```

Q11.Include 3 more numeric variables you think are sensible, cluster again, what are the results and why do you see that results?  
Q12.Try using different number of initial points (number of clusters), see at which point your number of clusters stablize.  




## Inputs and Outputs

You can embed Shiny inputs and outputs in your document. Outputs are automatically updated whenever inputs change.  This demonstrates how a standard R plot can be made interactive by wrapping it in the Shiny `renderPlot` function. The `selectInput` and `sliderInput` functions create the input widgets used to drive the plot.

```{r, echo=FALSE}
inputPanel(
  selectInput("n_breaks", label = "Number of bins:",
              choices = c(10, 20, 35, 50), selected = 20),
  
  sliderInput("bw_adjust", label = "Bandwidth adjustment:",
              min = 0.2, max = 2, value = 1, step = 0.2)
)

renderPlot({
  hist(faithful$eruptions, probability = TRUE, breaks = as.numeric(input$n_breaks),
       xlab = "Duration (minutes)", main = "Geyser eruption duration")
  
  dens <- density(faithful$eruptions, adjust = input$bw_adjust)
  lines(dens, col = "blue")
})
```

## Embedded Application

```{r, echo=FALSE}
shinyAppDir(
  system.file("examples/06_tabsets", package="shiny"),
  options=list(
    width="100%", height=550
  )
)
```




